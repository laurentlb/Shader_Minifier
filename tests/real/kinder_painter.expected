// Generated with  (https://github.com/laurentlb/Shader_Minifier/)
# define VAR_mouse "s"
# define VAR_resolution "v"
# define VAR_tex0 "w"
# define VAR_tex1 "f"
# define VAR_tex2 "o"
# define VAR_tex3 "b"
# define VAR_time "z"

// tests/real/kinder_painter.frag
"uniform vec2 v;"
 "uniform float z;"
 "uniform vec4 s;"
 "uniform sampler2D w,f,o,b;"
 "vec4 r[6],i[6];"
 "float t(vec4 z,vec3 m,vec3 v)"
 "{"
   "vec3 r=m-z.xyz;"
   "float w=dot(v.xz,v.xz),d=dot(v.xz,r.xz),s=dot(r.xz,r.xz)-z.w*z.w,i;"
   "i=d*d-w*s;"
   "if(i>0.)"
     "i=-(d+sqrt(i))/w;"
   "return i-.001;"
 "}"
 "float d(vec4 z,vec3 m,vec3 v)"
 "{"
   "vec3 r=m-z.xyz;"
   "float d=dot(v,r),i=dot(r,r)-z.w*z.w,w=d*d-i;"
   "if(w>0.)"
     "w=-d-sqrt(w);"
   "return w-.001;"
 "}"
 "bool d(vec4 z,vec3 m,vec3 v,float w)"
 "{"
   "vec3 r=m-z.xyz;"
   "float d=dot(v,r),i=dot(r,r)-z.w*z.w,f=d*d-i;"
   "bool s=false;"
   "if(f>0.)"
     "f=-d-sqrt(f),s=f>0.&&f<w;"
   "return s;"
 "}"
 "bool t(vec4 z,vec3 m,vec3 v,float w)"
 "{"
   "vec3 r=m-z.xyz;"
   "float s=dot(v.xz,v.xz),d=dot(v.xz,r.xz),i=dot(r.xz,r.xz)-z.w*z.w,f=d*d-s*i;"
   "bool b=false;"
   "if(f>0.)"
     "f=-(d+sqrt(f)),b=f>0.&&f<w*s;"
   "return b;"
 "}"
 "float n(vec4 v,vec3 z,vec3 r)"
 "{"
   "float w=dot(v.xyz,r);"
   "w=sign(w)*max(abs(w),.001);"
   "float d=-(dot(v.xyz,z)+v.w)/w;"
   "return d-.001;"
 "}"
 "vec3 n(vec4 v,vec4 z,vec3 m,out vec2 r)"
 "{"
   "vec3 w;"
   "r=z.w>2.5?"
     "(w.xz=m.xz-v.xz,w.y=0.,w/=v.w,vec2(w.x,m.y)):"
     "z.w>1.5?"
       "(w=v.xyz,m.xz*.2):"
       "(w=m-v.xyz,w/=v.w,w.xy);"
   "return w;"
 "}"
 "vec4 m(vec4 z,vec4 v,bool w)"
 "{"
   "return w?"
     "v:"
     "z;"
 "}"
 "float m(float z,float v,bool w)"
 "{"
   "return w?"
     "v:"
     "z;"
 "}"
 "int m(int z,int v,bool w)"
 "{"
   "return w?"
     "v:"
     "z;"
 "}"
 "float m(vec3 v,vec3 z,out vec4 w,out vec4 f)"
 "{"
   "float s=1e4,b;"
   "f.w=-1.;"
   "bool y;"
   "b=d(r[0],v,z);"
   "y=b>0.&&b<s;"
   "w=m(w,r[0],y);"
   "f=m(f,i[0],y);"
   "s=m(s,b,y);"
   "b=d(r[1],v,z);"
   "y=b>0.&&b<s;"
   "w=m(w,r[1],y);"
   "f=m(f,i[1],y);"
   "s=m(s,b,y);"
   "b=t(r[2],v,z);"
   "y=b>0.&&b<s;"
   "w=m(w,r[2],y);"
   "f=m(f,i[2],y);"
   "s=m(s,b,y);"
   "b=t(r[3],v,z);"
   "y=b>0.&&b<s;"
   "w=m(w,r[3],y);"
   "f=m(f,i[3],y);"
   "s=m(s,b,y);"
   "b=n(r[4],v,z);"
   "y=b>0.&&b<s;"
   "w=m(w,r[4],y);"
   "f=m(f,i[4],y);"
   "s=m(s,b,y);"
   "b=n(r[5],v,z);"
   "y=b>0.&&b<s;"
   "w=m(w,r[5],y);"
   "f=m(f,i[5],y);"
   "s=m(s,b,y);"
   "return s;"
 "}"
 "bool x(vec3 v,vec3 z,float y)"
 "{"
   "float w;"
   "bvec4 f;"
   "f.x=d(r[0],v,z,y);"
   "f.y=d(r[1],v,z,y);"
   "f.z=t(r[2],v,z,y);"
   "f.w=t(r[3],v,z,y);"
   "return any(f);"
 "}"
 "vec4 d(vec3 v,vec4 z,vec4 f,vec3 y,vec4 r,out vec4 s)"
 "{"
   "vec3 b;"
   "float d,i;"
   "vec2 m;"
   "b=n(z,f,v,m);"
   "d=dot(b,r.xyz);"
   "s.xyz=reflect(y,b);"
   "i=max(dot(s.xyz,r.xyz),0.);"
   "i*=i;"
   "i*=i;"
   "if(x(v,r.xyz,r.w))"
     "d=0.;"
   "f*=texture2D(w,m);"
   "d=max(d,0.);"
   "f=f*(vec4(.3,.34,.38,1)+.5*vec4(1,.95,.8,1)*d)+.5*i;"
   "d=dot(b,-y);"
   "s.w=d;"
   "d=1.-d*d;"
   "d*=d;"
   "f+=.35*vec4(d);"
   "return f;"
 "}"
 "void main()"
 "{"
   "vec4 f,y,w;"
   "vec3 b;"
   "vec4 o;"
   "vec2 x=-1.+2.*gl_FragCoord.xy/v.xy;"
   "x*=vec2(v.x/v.y,1);"
   "r[0]=vec4(1.2*sin(2.073423*z),0,1.8*sin(2.450409*z+1.),1);"
   "r[1]=vec4(1.5*sin(1.947761*z+4.),sin(1.822099*z+1.9),1.8*sin(1.822099*z),1);"
   "r[2]=vec4(-1.2,0,0,.4);"
   "r[3]=vec4(1.2,0,0,.4);"
   "r[4]=vec4(0,1,0,2);"
   "r[5]=vec4(0,-1,0,2);"
   "i[0]=vec4(.9,.8,.6,1);"
   "i[1]=vec4(1,.6,.4,1);"
   "i[2]=vec4(.8,.6,.5,3);"
   "i[3]=vec4(.5,.5,.7,3);"
   "i[4]=vec4(1,.9,.9,2);"
   "i[5]=vec4(1,.9,.9,2);"
   "float a=.15*z-6.2831*s.x/v.x,c=2.+3.*s.y/v.y;"
   "vec2 g=vec2(cos(a),sin(a));"
   "vec3 n=normalize(vec3(x.x*g.x-g.y,x.y,g.x+x.x*g.y)),t=vec3(c*g.y,0,-c*g.x);"
   "float u=m(t,n,y,w);"
   "vec3 e=t+n*u;"
   "f.xyz=vec3(0,1.5,-3)-e;"
   "f.w=length(f.xyz);"
   "f.xyz=f.xyz/f.w;"
   "w=d(e,y,w,n,f,o);"
   "vec4 C,D;"
   "u=m(e,o.xyz,y,C);"
   "e+=o.xyz*u;"
   "f.xyz=vec3(0,1.5,-1)-e;"
   "f.w=length(f.xyz);"
   "f.xyz=f.xyz/f.w;"
   "C=d(e,y,C,o.xyz,f,D);"
   "w=mix(w,C,.5-.5*o.w);"
   "gl_FragColor=w;"
 "}",
