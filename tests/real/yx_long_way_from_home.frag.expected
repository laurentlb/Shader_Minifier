/* File generated with 
 * http://www.ctrl-alt-test.fr
 */
#ifndef YX_LONG_WAY_FROM_HOME_FRAG_EXPECTED_
# define YX_LONG_WAY_FROM_HOME_FRAG_EXPECTED_
# define VAR_iChannel1 "v"

const char *yx_long_way_from_home_frag =
 "#version 130\n"
 "#define iResolution gl_TexCoord[0]\n"
 "#define iTime gl_TexCoord[0].z\n"
 "#define pi acos(-1.)\n"
 "#define BOKEH 1\n"
 "#define SHADING 1\n"
 "uniform sampler2D v;"
 "mat2 n(float v)"
 "{"
   "float y=cos(v),x=sin(v);"
   "return mat2(y,-x,x,y);"
 "}"
 "vec2 s(const float v)"
 "{"
   "return fract(sin(vec2(v,v+1.))*vec2(43758.5453123));"
 "}"
 "int i;"
 "float e(vec2 v)"
 "{"
   "vec2 y=vec2(.125,0),x=v-clamp(v,-y,y);"
   "return length(x.xy);"
 "}"
 "float f(vec2 v)"
 "{"
   "return smoothstep(.5,1.,cos(v.x*10.))*1.5+sin(v.x*1e2)*.5+.5;"
 "}"
 "float t(vec3 y)"
 "{"
   "float x=1e9,n,r;"
   "x=min(x,length(y-vec3(0,5,0))-2.5);"
   "vec3 c=y,l;"
   "c.x=abs(c.x-1.1)-.2;"
   "n=max(length(c.xz+vec2(0,5))-.01,c.y-5.);"
   "l=y;"
   "if(y.y<.3)"
     "{"
       "y.y+=texture(v,y.xz*.125).x*9e-4;"
       "y.y+=texture(v,y.xz*2.*.125).x*.0011;"
       "y.y+=texture(v,y.xz*4.*.125).x*.0021;"
       "y.y+=texture(v,y.xz*4.*.0625).x*.0051;"
       "y.y+=texture(v,y.xz*4.*.03125).x*.01;"
       "y.y+=sin(y.x*2.)*.05;"
       "y.y-=length(sin(y.xz*.5))*.1;"
       "y.z+=sin(y.x*.5)*.5;"
       "y.z+=step(.5,mod(y.x,1.))*.3-.15;"
       "y.x=mod(y.x,.5)-.25;"
       "float s=e(y.xz),z=smoothstep(.1,.13,s);"
       "y.y+=.1-z*.03;"
       "y.y-=smoothstep(.05,0.,abs(s-.16))*.004;"
       "y.y-=(1.-z)*.01*f(y.xz);"
     "}"
   "y.y-=smoothstep(2.,0.,length(l.xz+vec2(-1.5,3.5)))*.2;"
   "y.y-=smoothstep(2.,0.,length(l.xz+vec2(1,-2)))*.2;"
   "r=y.y;"
   "x=min(x,r);"
   "{"
     "vec3 s=y;"
     "s.xz=mod(s.xz-.5,1.)-.5;"
   "}"
   "y.y-=.25;"
   "i=n<x?"
     "1:"
     "0;"
   "x=min(x,n);"
   "return x*.9;"
 "}"
 "vec2 y;"
 "vec3 p(vec3 y)"
 "{"
   "vec3 v=cross(vec3(-1),y);"
   "return v;"
 "}"
 "vec3 e(vec3 v,float x)"
 "{"
   "v=normalize(v);"
   "vec3 z=normalize(p(v)),l=normalize(cross(v,z));"
   "vec2 s=y;"
   "s.x=s.x*2.*pi;"
   "s.y=pow(s.y,1./(x+1.));"
   "float i=sqrt(1.-s.y*s.y);"
   "return cos(s.x)*i*z+sin(s.x)*i*l+s.y*v;"
 "}"
 "vec3 h(vec3 v)"
 "{"
   "return vec3(1,2,3)*.2;"
 "}"
 "bool e(vec3 v,vec3 x,out vec3 y,out vec3 i,out float s)"
 "{"
   "float z=0.;"
   "for(int f=0;f<100;++f)"
     "{"
       "s=t(v+x*z);"
       "z+=s;"
       "if(abs(s)<.004)"
         "break;"
     "}"
   "y=v+x*z;"
   "if(abs(s)<.004)"
     "{"
       "vec2 f=vec2(.001,0);"
       "s=t(y);"
       "i=normalize(vec3(t(y+f.xyy)-s,t(y+f.yxy)-s,t(y+f.yyx)-s));"
       "return true;"
     "}"
   "return false;"
 "}"
 "vec3 f(vec3 v,float s)"
 "{"
   "v=normalize(v);"
   "vec3 x=normalize(p(v)),z=normalize(cross(v,x));"
   "vec2 f=y;"
   "f.x=f.x*2.*pi;"
   "f.y=1.-f.y*s;"
   "float i=sqrt(1.-f.y*f.y);"
   "return cos(f.x)*i*x+sin(f.x)*i*z+f.y*v;"
 "}"
 "vec3 h(vec3 v,vec3 x)"
 "{"
   "vec3 c=normalize(vec3(.3,.36,-1)),z,r;"
   "const vec3 l=vec3(1,.6,.2)*2.;"
   "z=vec3(1);"
   "r=vec3(0);"
   "for(int n=0;n<10;++n)"
     "{"
       "vec3 t,a;"
       "float p;"
       "if(e(v,x,t,a,p))"
         "{"
           "float m=1.,o,k;"
           "vec3 g=vec3(1),b,u,d;"
           "if(i==1)"
             "g=vec3(.7);"
           "m*=m;"
           "{"
             "v=t+a*.002;"
             "vec3 S=reflect(x,a),R=e(a,1.);"
             "x=normalize(mix(S,R,m));"
             "z*=g;"
           "}"
           "b=f(c,1e-4);"
           "o=dot(a,b);"
           "if(o>0.&&!e(t+a*.002,b,u,d,k))"
             "r+=z*o*l;"
           "y=s(y.y);"
         "}"
       "else"
         " if(abs(p)>.1)"
           "return r+h(x)*z;"
         "else"
           " break;"
     "}"
   "return vec3(0);"
 "}"
 "vec2 e()"
 "{"
   "vec2 v=y;"
   "if(v.y>v.x)"
     "v=1.-v;"
   "v.y*=pi*2./v.x;"
   "return v.x*vec2(cos(v.y),sin(v.y));"
 "}"
 "void main()"
 "{"
   "vec2 v=gl_FragCoord.xy/iResolution.xy-.5,x;"
   "float f=iTime+(v.x+iResolution.x*v.y)*1.51269341231,z,i;"
   "y=s(f);"
   "v+=(y-.5)/iResolution.xy;"
   "v.x*=iResolution.x/iResolution.y;"
   "const vec3 c=vec3(-4,2,3),t=vec3(0);"
   "const float l=distance(c,t);"
   "const vec2 p=vec2(1,2)*.015;"
   "vec3 r=vec3(0),o=normalize(vec3(v,2)),a;"
   "x=e();"
   "r.xy+=x*p;"
   "o.xy-=x*p*o.z/l;"
   "a=t-c;"
   "z=-atan(a.y,length(a.xz));"
   "i=-atan(a.x,a.z);"
   "r.yz*=n(z);"
   "o.yz*=n(z);"
   "r.xz*=n(i);"
   "o.xz*=n(i);"
   "r+=c;"
   "vec4 m=vec4(h(r,o),1);"
   "gl_FragColor=!isnan(m.x)&&m.x>=0.?"
     "m:"
     "vec4(0);"
 "}";

#endif // YX_LONG_WAY_FROM_HOME_FRAG_EXPECTED_
